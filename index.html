<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مكتبة الكود العربي</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <script src="scripts.js" defer></script>
</head>
<body>
    <header>
        <h1>مكتبة الكود العربي</h1>
        <nav>
            <button onclick="navigate('home')" class="nav-btn">الرئيسية</button>
            <button onclick="navigate('scripts')" class="nav-btn">نشر سكربت</button>
            <button onclick="navigate('contact')" class="nav-btn">اتصل بنا</button>
        </nav>
    </header>

    <!-- قسم الرئيسية -->
    <main id="home" class="content">
        <h2>مرحباً بك في مكتبة الكود العربي!</h2>
        <p>شارك أكوادك البرمجية بأمان واحترافية.</p>
    </main>

    <!-- قسم نشر السكربت -->
    <main id="scripts" class="content" style="display: none;">
        <h2>نشر سكربت جديد</h2>
        <form id="scriptForm">
            <input type="text" id="scriptTitle" placeholder="عنوان السكربت" required>
            <textarea id="scriptContent" placeholder="أدخل السكربت هنا..." required></textarea>
            <input type="text" id="imageLink" placeholder="أدخل رابط الصورة هنا (اختياري)">
            <button type="submit" class="submit-btn">نشر السكربت</button>
        </form>
        <div id="scriptsList">
            <p id="noScriptsMsg">لا توجد سكربتات منشورة بعد.</p>
        </div>
        <div id="scriptImage" style="display: none;">
            <img id="imagePreview" src="" alt="صورة السكربت" width="200">
        </div>
    </main>

    <!-- قسم اتصل بنا -->
    <main id="contact" class="content" style="display: none;">
        <h2>تواصل معنا</h2>
        <p>
            <a href="https://instagram.com/ntlk.afan" target="_blank">
                <img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png" alt="Instagram" width="30">
                ntlk.afan
            </a>
        </p>
    </main>

    <!-- قسم تسجيل الدخول -->
    <main id="login" class="content" style="display: none;">
        <h2>تسجيل الدخول</h2>
        <form id="loginForm">
            <input type="text" id="loginUsername" placeholder="اسم المستخدم" required>
            <input type="password" id="loginPassword" placeholder="كلمة المرور" required>
            <button type="submit" class="submit-btn">تسجيل الدخول</button>
        </form>
        <p>ليس لديك حساب؟ <a href="#" id="registerLink">إنشاء حساب</a></p>
    </main>

    <!-- قسم إنشاء الحساب -->
    <main id="register" class="content" style="display: none;">
        <h2>إنشاء حساب جديد</h2>
        <form id="registerForm">
            <input type="text" id="registerUsername" placeholder="اسم المستخدم" required>
            <input type="password" id="registerPassword" placeholder="كلمة المرور" required>
            <button type="submit" class="submit-btn">إنشاء حساب</button>
        </form>
    </main>

    <footer>
        <p>© 2025 مكتبة الكود العربي - جميع الحقوق محفوظة</p>
    </footer>

    <script>
        document.getElementById('scriptForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const imageLink = document.getElementById('imageLink').value;
            if (imageLink) {
                const imageUrl = imageLink.includes('raw=true') ? imageLink : imageLink + '?raw=true';
                document.getElementById('imagePreview').src = imageUrl;
                document.getElementById('scriptImage').style.display = 'block';
            } else {
                document.getElementById('scriptImage').style.display = 'none';
            }

            const scriptTitle = document.getElementById('scriptTitle').value;
            const scriptContent = document.getElementById('scriptContent').value;
            const scriptList = document.getElementById('scriptsList');

            const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));

            if (loggedInUser && loggedInUser.role === 'owner') {
                let scripts = JSON.parse(localStorage.getItem('scripts')) || [];
                const newScript = { title: scriptTitle, content: scriptContent };
                scripts.push(newScript);
                localStorage.setItem('scripts', JSON.stringify(scripts));

                const scriptDiv = document.createElement('div');
                scriptDiv.innerHTML = `<h3>${scriptTitle}</h3><p>${scriptContent}</p>`;
                scriptList.appendChild(scriptDiv);
            } else {
                alert('أنت ضيف ولا يمكنك نشر السكربتات.');
            }

            document.getElementById('scriptForm').reset();
        });

        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            const storedUsers = JSON.parse(localStorage.getItem('users')) || [];
            const user = storedUsers.find(user => user.username === username && user.password === password);

            if (user) {
                alert('تم تسجيل الدخول بنجاح!');
                localStorage.setItem('loggedInUser', JSON.stringify(user));
                navigate('home');
            } else {
                alert('اسم المستخدم أو كلمة المرور غير صحيحة');
            }
        });

        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('registerUsername').value;
            const password = document.getElementById('registerPassword').value;

            let users = JSON.parse(localStorage.getItem('users')) || [];
            users.push({ username, password, role: 'guest' });
            localStorage.setItem('users', JSON.stringify(users));

            alert('تم إنشاء الحساب بنجاح! يمكنك الآن تسجيل الدخول.');
            navigate('login');
        });

        document.getElementById('registerLink').addEventListener('click', function() {
            navigate('register');
        });

        function navigate(sectionId) {
            document.querySelectorAll('.content').forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById(sectionId).style.display = 'block';
        }

        window.addEventListener('load', () => {
            const scripts = JSON.parse(localStorage.getItem('scripts')) || [];
            const scriptList = document.getElementById('scriptsList');

            scripts.forEach(script => {
                const scriptDiv = document.createElement('div');
                scriptDiv.innerHTML = `<h3>${script.title}</h3><p>${script.content}</p>`;
                scriptList.appendChild(scriptDiv);
            });
        });
    </script>
</body>
</html>
